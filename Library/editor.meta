|
	current=map.Merging
		System
		System.IO
		System.Windows.Forms
		System.Drawing
		parent
		boolean
		map
		number
		array
	choose=
		' TODO: rename dialog to openFileDialog
		OpenFile=
			|
				dialog=OpenFileDialog*
				dialog.ShowDialog*
				current=dialog.FileName.Get*
		SaveFile=
			|
				dialog=SaveFileDialog*
				dialog.ShowDialog*
				current=dialog.FileName.Get*
	file=
		' TODO: use keyword arguments
		Write=
			|
				writer=StreamWriter
					parameter.1
				writer.Write
					parameter.2
				writer.Close*
		Read=
			|
				reader=StreamReader
					parameter
				result=reader.ReadToEnd*
				reader.Close*
				current=result
	fileName=*
	SetFileName=
		|
			parent.parent.fileName=parameter
			form.Text.Set
				Concatenation
					<Meta Edit - >
					fileName
	SetBreakPoint=
		|Meta.Expression.BreakPoint.Set
			Meta.BreakPoint
				fileName
				Meta.SourcePosition
					editBox.RealLine.Get*
					editBox.Column.Get*
	SetBreakPoint=
		|
			asdjfasdf
	commands=
		SaveAs=
			|
				saveAs=choose.SaveFile*
				hasName=Negation Equality
					saveAs
					*
				cases=
					0=
						|*
					1=
						|
							SetFileName saveAs
							file.Write
								fileName
								editBox.RealText.Get*
				cases.[hasName]*
		Save=
			|
				hasName=Negation Equality
					fileName
					*
				cases=
					1=
						|commands.SaveAs*
					0=
						|file.Write
							fileName
							editBox.RealText.Get*
				cases.[hasName]*
		Open=
			|
				openFileName=choose.OpenFile*
				hasName=Negation Equality
					openFileName
					*
				cases=
					0=
						|*
					1=
						|
							SetFileName openFileName
							editBox.RealText.Set
								file.Read fileName
							'editBox.MoveRealCursor
							'	<0>
							'	<0>
				cases.[hasName]*
		Run=
			|
				commands.Save*
				SetBreakPoint*
				Meta.Interpreter.Break.Add
					=
						|editBox.ShowDebugValue
							parameter.1
				Meta.Interpreter.StartDebug
					fileName
		Continue=
			|
				SetBreakPoint*
				Meta.Interpreter.ContinueDebug*
		Reverse=
			|
				SetBreakPoint*
				Meta.Interpreter.ReverseDebug*
	CombinedModifierKeys=
		current=System.Windows.Forms
		AltControl=bitwise.Disjunction
			Keys.Alt
			Keys.Control
		AltShift=bitwise.Disjunction
			Keys.Alt
			Keys.Shift
		AltControlShift=bitwise.Disjunction
			Keys.Alt
			Keys.Control
			Keys.Shift
		ControlShift=bitwise.Disjunction
			Keys.Control
			Keys.Shift
	shortcutCombinations=
		current=System.Windows.Forms
		[Keys.None]=
			[Keys.Escape]=
				|editBox.StopInteractiveSearch*
			[Keys.F5]=
				|commands.Run*
			[Keys.F5]=
				|commands.Run*
			[Keys.Up]=
				|editBox.MoveLineUp*
			[Keys.Down]=
				|editBox.MoveLineDown*
			[Keys.Left]=
				|editBox.MoveCharLeft*
			[Keys.Right]=
				|editBox.MoveCharRight*
			[Keys.Home]=
				|editBox.MoveLineStart*
			[Keys.End]=
				|editBox.MoveLineEnd*
			[Keys.Tab]=
				|editBox.IncreaseSelectionIndent*
			[Keys.Back]=
				|editBox.DeleteCharLeft*
			[Keys.Delete]=	
				|editBox.DeleteCharRight*
			[Keys.PageUp]=
				|editBox.MovePageUp*
			[Keys.PageDown]=
				|editBox.MovePageDown*
		[Keys.Shift]=
			[Keys.Tab]=
				|editBox.DecreaseSelectionIndent*
			[Keys.Left]=
				|editBox.SelectCharLeft*
			[Keys.Right]=
				|editBox.SelectCharRight*
		[Keys.Control]=
			[Keys.O]=
				|commands.Open*
			[Keys.S]=
				|commands.Save*
			[Keys.I]=
				|editBox.StartInteractiveSearch*
			[Keys.H]=
				|editBox.FindAndReplace*
			[Keys.Left]=
				|editBox.MoveWordLeft*
			[Keys.Right]=
				|editBox.MoveWordRight*
			[Keys.Back]=
				|editBox.DeleteWordLeft*
			[Keys.Delete]=
				|editBox.DeleteWordRight*
			[Keys.Home]=
				|editBox.MoveDocumentStart*
			[Keys.End]=
				|editBox.MoveDocumentEnd*
		[Keys.Alt]=
			[Keys.K]=
				|editBox.MoveLineDown*
			[Keys.L]=
				|editBox.MoveLineUp*
			[Keys.Oemtilde]=
				|editBox.MoveCharRight*
			[Keys.J]=
				|editBox.MoveCharLeft*
			[Keys.U]=
				|editBox.MoveLineStart*
			[Keys.OemSemicolon]=
				|editBox.MoveLineEnd*
			[Keys.N]=
				|editBox.DeleteCharLeft*
			[Keys.M]=
				|editBox.DeleteCharRight*
		[CombinedModifierKeys.ControlShift]=
			[Keys.Left]=
				|editBox.SelectWordLeft*
			[Keys.Right]=
				|editBox.SelectWordRight*
		[CombinedModifierKeys.AltShift]=
			[Keys.J]=
				|editBox.SelectCharLeft*
			[Keys.Oemtilde]=
				|editBox.SelectCharRight*
			[Keys.L]=
				|editBox.SelectLineUp*
			[Keys.K]=
				|editBox.SelectLineDown*
			[Keys.OemSemicolon]=
				|editBox.SelectLineEnd*
			[Keys.U]=
				|editBox.SelectLineStart*
		[CombinedModifierKeys.AltControl]=
			[Keys.J]=
				|editBox.MoveWordLeft*
			[Keys.Oemtilde]=
				|editBox.MoveWordRight*
			[Keys.OemSemicolon]=
				|editBox.MoveDocumentEnd*
			[Keys.U]=
				|editBox.MoveDocumentStart*
			[Keys.N]=
				|editBox.DeleteWordLeft*
			[Keys.M]=
				|editBox.DeleteWordRight*
			[Keys.L]=
				|editBox.MovePageUp*
			[Keys.K]=
				|editBox.MovePageDown*
		[CombinedModifierKeys.AltControlShift]=
			[Keys.J]=
				|editBox.SelectWordLeft*
			[Keys.Oemtilde]=
				|editBox.SelectWordRight*
	editBox=
		editBox=ScrollingTextBox*
		editBox.ShowSelectionMargin.Set
			<1>
		editBox.AcceptsTab.Set
			<1>
		editBox.Dock.Set
			DockStyle.Fill
		editBox.ScrollBars.Set
			RichTextBoxScrollBars.ForcedBoth
		editBox.KeyDown.Add
			=
				' annoying
				|
					eventArgs=parameter.2
					modifier=eventArgs.Modifiers.Get*
					key=eventArgs.KeyCode.Get*
					shortcuts=shortcutCombinations.[modifier]
					exists=Containment
						map=shortcuts
						key=key
					cases=
						1=
							|
								editBox.SuspendWindowUpdate*
								shortcuts.[key]*
								editBox.ResumeWindowUpdate*
								eventArgs.Handled.Set
									<1>
						0=
							|*
					cases.[exists]*
		current=editBox
	form=
		form=Form*
		form.Text.Set
			<Meta Edit>
		form.Font.Set
			Font
				<Courier New>
				<10>
		controls=form.Controls.Get*
		controls.AddRange
			=
				editBox
		'form.WindowState.Set
		'	FormWindowState.Maximized
		menu=
			File=
				[<Open...>]=commands.Open
				[<Save>]=commands.Save
				[<Save as...>]=commands.SaveAs
				[<Close>]=
					|form.Close*
			Program=
				Start=commands.Run
				Continue=commands.Continue
				Reverse=commands.Reverse
		form.Menu.Set
			MainMenu
				Application
					array=Keys menu
					function=
						|
							topKey=parameter
							current=MenuItem
								topKey
								Application
									array=Keys menu.[topKey]
									function=
										|MenuItem
											parameter
											menu.[topKey].[parameter]
		current=form
	form.ShowDialog*