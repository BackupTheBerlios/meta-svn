this:map.Merging
	System
	System.IO
	System.Windows.Forms
	System.Drawing
	parent
	logic
	map
	math
	array
choose:
	// TODO: rename dialog to openFileDialog
	OpenFile:=
		dialog:OpenFileDialog*
		dialog.ShowDialog*
		this:dialog.FileName.get*
	SaveFile:=
		dialog:SaveFileDialog*
		dialog.ShowDialog*
		this:dialog.FileName.get*
file:
	Write:=
		writer:StreamWriter
			arg.1
		writer.Write
			arg.2
		writer.Close*
	Read:=
		reader:StreamReader
			arg
		result:reader.ReadToEnd*
		reader.Close*
		this:result
fileName:*
SetFileName:=
	parent.parent.fileName:arg
	form.Text.set
		Concatenation
			"Meta Edit - "
			fileName
SetBreakPoint:=Meta.Expression.BreakPoint.set
	Meta.BreakPoint
		fileName
		Meta.SourcePosition
			editBox.RealLine.get*
			editBox.Column.get*
SetBreakPoint:=
	asdjfasdf
commands:
	SaveAs:=
		saveAs:choose.SaveFile*
		hasName:Negation Equality
			saveAs
			*
		cases:
			0:=*
			1:=
				SetFileName saveAs
				file.Write
					fileName
					editBox.RealText.get*
		cases.[hasName]*
	Save:=
		hasName:Negation Equality
			fileName
			*
		cases:
			1:=commands.SaveAs*
			0:=file.Write
				fileName
				editBox.RealText.get*
		cases.[hasName]*
	Open:=
		openFileName:choose.OpenFile*
		hasName:Negation Equality
			openFileName
			*
		cases:
			0:=*
			1:=
				SetFileName openFileName
				editBox.RealText.set
					file.Read fileName
				editBox.MoveRealCursor
					"0"
					"0"
		cases.[hasName]*
	Run:=
		commands.Save*
		SetBreakPoint*
		Meta.Interpreter.Break.add
			=editBox.ShowDebugValue
				arg.1
		Meta.Interpreter.StartDebug
			fileName
	Continue:=
		SetBreakPoint*
		Meta.Interpreter.ContinueDebug*
	Reverse:=
		SetBreakPoint*
		Meta.Interpreter.ReverseDebug*
CombinedModifierKeys:
	this:System.Windows.Forms
	AltControl:bitwise.Disjunction
		Keys.Alt
		Keys.Control
	AltShift:bitwise.Disjunction
		Keys.Alt
		Keys.Shift
	AltControlShift:bitwise.Disjunction
		Keys.Alt
		Keys.Control
		Keys.Shift
	ControlShift:bitwise.Disjunction
		Keys.Control
		Keys.Shift
shortcutCombinations:
	this:System.Windows.Forms
	[Keys.None]:=
		[Keys.Escape]:=editBox.StopInteractiveSearch*
		[Keys.F5]:=commands.Run*
		[Keys.F5]:=commands.Run*
		[Keys.Up]:=editBox.MoveLineUp*
		[Keys.Down]:=editBox.MoveLineDown*
		[Keys.Left]:=editBox.MoveCharLeft*
		[Keys.Right]:=editBox.MoveCharRight*
		[Keys.Home]:=editBox.MoveLineStart*
		[Keys.End]:=editBox.MoveLineEnd*
		[Keys.Tab]:=editBox.IncreaseSelectionIndent*
		[Keys.Back]:=editBox.DeleteCharLeft*
		[Keys.Delete]:=editBox.DeleteCharRight*
		[Keys.PageUp]:=editBox.MovePageUp*
		[Keys.PageDown]:=editBox.MovePageDown*
	[Keys.Shift]:
		[Keys.Tab]:=editBox.DecreaseSelectionIndent*
		[Keys.Left]:=editBox.SelectCharLeft*
		[Keys.Right]:=editBox.SelectCharRight*
	[Keys.Control]:
		[Keys.O]:=commands.Open*
		[Keys.S]:=commands.Save*
		[Keys.I]:=editBox.StartInteractiveSearch*
		[Keys.H]:=editBox.FindAndReplace*
		[Keys.Left]:=editBox.MoveWordLeft*
		[Keys.Right]:=editBox.MoveWordRight*
		[Keys.Back]:=editBox.DeleteWordLeft*
		[Keys.Delete]:=editBox.DeleteWordRight*
		[Keys.Home]:=editBox.MoveDocumentStart*
		[Keys.End]:=editBox.MoveDocumentEnd*
	[Keys.Alt]:
		[Keys.K]:=editBox.MoveLineDown*
		[Keys.L]:=editBox.MoveLineUp*
		[Keys.Oemtilde]:=editBox.MoveCharRight*
		[Keys.J]:=editBox.MoveCharLeft*
		[Keys.U]:=editBox.MoveLineStart*
		[Keys.OemSemicolon]:=editBox.MoveLineEnd*
		[Keys.N]:=editBox.DeleteCharLeft*
		[Keys.M]:=editBox.DeleteCharRight*
	[CombinedModifierKeys.ControlShift]:
		[Keys.Left]:=editBox.SelectWordLeft*
		[Keys.Right]:=editBox.SelectWordRight*
	[CombinedModifierKeys.AltShift]:
		[Keys.J]:=editBox.SelectCharLeft*
		[Keys.Oemtilde]:=editBox.SelectCharRight*
		[Keys.L]:=editBox.SelectLineUp*
		[Keys.K]:=editBox.SelectLineDown*
		[Keys.OemSemicolon]:=editBox.SelectLineEnd*
		[Keys.U]:=editBox.SelectLineStart*
	[CombinedModifierKeys.AltControl]:
		[Keys.J]:=editBox.MoveWordLeft*
		[Keys.Oemtilde]:=editBox.MoveWordRight*
		[Keys.OemSemicolon]:=editBox.MoveDocumentEnd*
		[Keys.U]:=editBox.MoveDocumentStart*
		[Keys.N]:=editBox.DeleteWordLeft*
		[Keys.M]:=editBox.DeleteWordRight*
		[Keys.L]:=editBox.MovePageUp*
		[Keys.K]:=editBox.MovePageDown*
	[CombinedModifierKeys.AltControlShift]:
		[Keys.J]:=editBox.SelectWordLeft*
		[Keys.Oemtilde]:=editBox.SelectWordRight*
editBox:
	editBox:ScrollingTextBox*
	editBox.ShowSelectionMargin.set
		"1"
	editBox.AcceptsTab.set
		"1"
	editBox.Dock.set
		DockStyle.Fill
	editBox.ScrollBars.set
		RichTextBoxScrollBars.ForcedBoth
	editBox.KeyDown.add
		:
			// annoying
			'
				eventArgs:arg.2
				modifier:eventArgs.Modifiers.get*
				key:eventArgs.KeyCode.get*
				shortcuts:shortcutCombinations.[modifier]
				exists:Containment
					map:shortcuts
					key:key
				cases:
					1:=
						editBox.SuspendWindowUpdate*
						shortcuts.[key]*
						editBox.ResumeWindowUpdate*
						eventArgs.Handled.set
							"1"
					0:=*
				cases.[exists]*
	this:editBox
form:
	form:Form*
	form.Text.set
		"Meta Edit"
	form.Font.set
		Font
			"Courier New"
			"10"
	controls:form.Controls.get*
	controls.AddRange
		:
			editBox
	//form.WindowState.set
	//	FormWindowState.Maximized
	menu:
		File:
			["Open..."]:commands.Open
			["Save"]:commands.Save
			["Save as..."]:commands.SaveAs
			["Close"]:=form.Close*
		Program:
			Start:commands.Run
			Continue:commands.Continue
			Reverse:commands.Reverse
	form.Menu.set
		MainMenu
			Application
				array:Keys menu
				function:=
					topKey:arg
					this:MenuItem
						topKey
						Application
							array:Keys menu.[topKey]
							function:=MenuItem
								arg
								menu.[topKey].[arg]
	this:form
form.ShowDialog*