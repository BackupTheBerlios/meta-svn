|,
	&=-
		sum
		+
			System
			PresentationFramework
			PresentationCore
			windowsbase
			mscorlib
			Meta
		merge
	listProgramView=,
		create=,
			|-
				listProgramView
				,
					program=+
						,
							key=+
								,
									lookup=,
										literal=1
							value=,
								literal=" "
		source|,
			&=-
				control
				-
					apply
					.
						source
						program
					,
						statement|-
							parse
							.
								statement
								value
			Background=.
				Brushes
				Green
			getMap=,
				|,
					program=-
						foreach
						-
							enumerableToArray
							Children
						,
							key|,
								value|,
									key=+
										,
											lookup=,
												literal=key
									value=-
										.
											value
											getMap
			keys=,
				<.
					ModifierKeys
					Alt=,
					<.
						Key
						Enter=,
						|-
							.
								Children
								Add_UIElement
							-
								view
								-
									.
										literalView
										create
			KeyDown=-
				keyMapping
				keys
	emptyView=,
		|,
			&=-
				textBox
			Background=.
				Brushes
				Red
			PreviewTextInput=,
				|,
					e|,
						.
							!e
							Handled=1
			getMap=,
				|0
	textBox=,
		|,
			&=-
				TextBox
			AcceptsReturn=1
			GotFocus=,
				|,
					|-
						SelectAll
	horizontal=.
		Orientation
		Horizontal
	stringView=,
		create=,
			|-
				stringView
				" "
		text|,
			&=-
				textBox
			Text=text
			Background=.
				Brushes
				Fuchsia
			getMap=,
				|Text
	numberView=,
		number|,
			&=-
				textBox
			Background=.
				Brushes
				LightYellow
			Text=-
				integerToString
				number
			getMap=,
				|-
					stringToInteger
					Text
			PreviewTextInput=,
				|,
					e|-
						apply
						.
							e
							Text
						,
							c|-
								if
								-
									not
									-
										.
											Char
											IsDigit_Char
										c
								,
									then=,
										|,
											.
												!e
												Handled=1
	multi=,
		views|,
			&=-
				StackPanel
			Margin=-
				Thickness_Double
				2
			Children=views
			Orientation=.
				PresentationFramework
				Orientation
				Vertical
			<.
				FrameworkElement
				HorizontalAlignmentProperty=.
				PresentationFramework
				HorizontalAlignment
				Left
			MouseLeftButtonDown=,
				|,
					e|,
						.
							!e
							Handled=1
						asdf=-
							.
								panel
								Focus
	entry=,
		create=,
			|-
				entry
				-
					.
						stringView
						create
				-
					.
						stringView
						create
		key|,
			value|,
				&=-
					control
					+
						key
						value
				Orientation=.
					PresentationFramework
					Orientation
					Horizontal
				getKey=,
					|-
						.
							Children
							0
							getMap
				getValue=,
					|-
						.
							Children
							1
							getMap
				KeyDown=-
					keyMapping
					,
						<.
							ModifierKeys
							Alt=,
							<.
								Key
								Enter=,
								|-
									.
										Parent
										Children
										Insert_Int32_UIElement
									-
										add
										-
											.
												Parent
												Children
												IndexOf_UIElement
											this
										1
									-
										.
											entry
											create
	copied=0
	view=,
		content|,
			&=-
				multi
				+
					content
			Margin=-
				Thickness_Double
				2
			Orientation=horizontal
			<.
				FrameworkElement
				HorizontalAlignmentProperty=.
				PresentationFramework
				HorizontalAlignment
				Left
			<.
				FrameworkElement
				VerticalAlignmentProperty=.
				PresentationFramework
				VerticalAlignment
				Top
			getMap=,
				|-
					.
						Children
						0
						getMap
			setView=,
				view|,
					!Children=+
						view
			keys=,
				<.
					ModifierKeys
					Alt=-
					merge
					,
						<.
							Key
							B
						=,
							|,
								!copied=-
									getMap
						<.
							Key
							M
						=,
							|-
								setView
								-
									parse
									c
						<.
							Key
							R=,
							|-
								.
									commands
									Debug
									Run
						<.
							Key
							Delete=,
							|-
								.
									Parent
									Children
									Remove_UIElement
								this
					-
						sum
						-
							foreach
							,
								<.
									Key
									U
								=stringView
								<.
									Key
									V
								=.
									lookupView
									create
								<.
									Key
									L
								=.
									literalView
									create
								<.
									Key
									N
								=numberView
								<.
									Key
									E
								=emptyView
								<.
									Key
									A
								=.
									listProgramView
									create
								<.
									Key
									P
								=.
									programView
									create
								<.
									Key
									S
								=.
									selectView
									create
								<.
									Key
									T
								=.
									currentView
									create
								<.
									Key
									F
								=.
									searchView
									create
								<.
									Key
									C
								=.
									callView
									create
							,
								key|,
									value|,
										<key=,
											|+
												-
													setView
													-
														value
														0
												-
													.
														Children
														0
														Focus
						merge
			KeyDown=-
				keyMapping
				keys
	keyMapping=,
		keys|,
			sender|,
				e|-
					callIf
					keys
					.
						e
						KeyboardDevice
						Modifiers
					,
						functions|+
							-
								print
								"in keyMapping"
							-
								callIf
								functions
								.
									e
									SystemKey
								,
									func|,
										asdf=-
											print
											.
												e
												SystemKey
										asdf=-
											func
										.
											!e
											Handled=1
	control=,
		children|,
			&=-
				multi
				children
			Focusable=1
	functionView=,
		key|,
			value|,
				&=-
					control
					+
						-
							view
							-
								stringView
								.
									value
									parameter
						-
							parse
							.
								value
								expression
				getKey=,
					|"function"
				getValue=,
					|,
						parameter=-
							.
								Children
								0
								getMap
						expression=-
							.
								Children
								1
								getMap
				Background=.
					Brushes
					Azure
	statementBase=,
		children|,
			&=-
				control
				children
			keys=,
				<.
					ModifierKeys
					Alt
				=,
					<.
						Key
						Y
					=,
						|-
							.
								Parent
								Parent
								Children
								Insert_Int32_UIElement
							-
								add
								-
									.
										Parent
										Parent
										Children
										IndexOf_UIElement
									Parent
								1
							-
								view
								-
									.
										functionStatementView
										create
					<.
						Key
						Enter
					=,
						|-
							.
								Parent
								Parent
								Children
								Insert_Int32_UIElement
							-
								add
								-
									.
										Parent
										Parent
										Children
										IndexOf_UIElement
									Parent
								1
							-
								view
								-
									.
										statementView
										create
			KeyDown=-
				keyMapping
				keys
	statementView=,
		create=,
			|-
				statementView
				,
					key=+
						,
							lookup=,
								literal=" "
					value=,
						literal=" "
		source|,
			&=-
				statementBase
				+
					-
						parse
						,
							select=.
								source
								key
					-
						parse
						.
							source
							value
			Orientation=.
				PresentationFramework
				Orientation
				Horizontal
			getMap=,
				|,
					key=.
						-
							.
								Children
								0
								getMap
						select
					value=-
						.
							Children
							1
							getMap
			Background=.
				Brushes
				Gray
	functionStatementView=,
		create=,
			|-
				functionStatementView
				,
					value=,
						literal=,
							parameter="arg"
							expression=,
								literal="hello"
		source|,
			&=-
				statementBase
				+
					-
						view
						-
							stringView
							.
								source
								value
								literal
								parameter
					-
						parse
						.
							source
							value
							literal
							expression
			getMap=,
				|,
					key=+
						,
							lookup=,
								literal="function"
					value=,
						literal=,
							parameter=-
								.
									Children
									0
									getMap
							expression=-
								.
									Children
									1
									getMap
			Background=.
				Brushes
				Azure
	programView=,
		create=,
			|-
				programView
				,
					program=+
						,
							key=+
								,
									lookup=,
										literal=" "
							value=,
								literal=" "
		source|,
			&=-
				control
				-
					apply
					.
						source
						program
					,
						statement|-
							view
							-
								if
								-
									equal
									.
										statement
										key
									+
										,
											lookup=,
												literal="function"
								,
									then=,
										|-
											functionStatementView
											statement
									else=,
										|-
											statementView
											statement
			Background=.
				Brushes
				Blue
			getMap=,
				|,
					program=-
						apply
						-
							enumerableToArray
							Children
						,
							entry|-
								.
									entry
									getMap
	mapView=,
		create=,
			|-
				mapView
				,
					"hello"="world"
		entries|,
			&=-
				control
				-
					foreach
					entries
					,
						key|,
							value|-
								if
								-
									equal
									key
									"function"
								,
									then=,
										|-
											functionView
											key
											value
									else=,
										|-
											entry
											-
												parse
												key
											-
												parse
												value
			getMap=,
				|-
					sum
					-
						apply
						-
							enumerableToArray
							Children
						,
							entry|,
								<-
									.
										entry
										getKey=-
									.
										entry
										getValue
					merge
	callView=,
		create=,
			|-
				callView
				,
					call=+
						,
							select=+
								,
									search=,
										literal="hello"
						,
							literal="world"
		source|,
			&=-
				control
				-
					apply
					.
						source
						call
					,
						arg|-
							parse
							arg
			Background=.
				Brushes
				BurlyWood
			getMap=,
				|,
					call=-
						apply
						-
							enumerableToArray
							Children
						,
							child|-
								.
									child
									getMap
			keys=,
				<.
					ModifierKeys
					Alt
				=,
					<.
						Key
						Enter
					=,
						|-
							.
								Children
								Add_UIElement
							-
								view
								-
									.
										literalView
										create
			KeyDown=-
				keyMapping
				keys
	lookupView=,
		create=,
			|-
				lookupView
				,
					lookup=,
						literal="hello"
		source|,
			&=-
				control
				+
					-
						parse
						.
							source
							lookup
			getMap=,
				|,
					lookup=-
						.
							Children
							0
							getMap
			Background=.
				Brushes
				MistyRose
	searchView=,
		create=,
			|-
				searchView
				,
					search=,
						literal="hello"
		source|,
			&=-
				control
				+
					-
						parse
						.
							source
							search
			getMap=,
				|,
					search=-
						.
							Children
							0
							getMap
			Background=.
				Brushes
				DeepSkyBlue
	literalView=,
		create=,
			|-
				literalView
				,
					literal=" "
		source|,
			&=-
				control
				+
					-
						parse
						.
							source
							literal
			getMap=,
				|,
					literal=-
						.
							Children
							0
							getMap
			Background=.
				Brushes
				DarkViolet
	currentView=,
		create=,
			|-
				currentView
		|,
			&=-
				textBox
			Background=.
				Brushes
				White
			PreviewTextInput=,
				|,
					e|,
						.
							!e
							Handled=1
			getMap=,
				|,
					current=0
	selectView=,
		create=,
			|-
				selectView
				,
					select=+
						,
							search=,
								literal="hello"
		source|,
			&=-
				control
				-
					apply
					.
						source
						select
					,
						arg|-
							parse
							arg
			keys=,
				<.
					ModifierKeys
					Alt
				=,
					<.
						Key
						Enter
					=,
						|-
							.
								Children
								Add_UIElement
							-
								view
								-
									.
										lookupView
										create
			KeyDown=-
				keyMapping
				keys
			getMap=,
				|,
					select=-
						apply
						-
							enumerableToArray
							Children
						,
							child|-
								.
									child
									getMap
			Background=.
				Brushes
				Chocolate
	parse=,
		arg|-
			view
			-
				case
				arg
				,
					<isEmpty=emptyView
					<isString=stringView
					<isNumber=numberView
					<,
						|-
							hasKey
							arg
							"call"=callView

					<,
						|-
							hasKey
							arg
							"call"=callView
					<,
						|-
							hasKey
							arg
							"literal"=literalView
					<,
						|-
							hasKey
							arg
							"search"=searchView
					<,
						|-
							hasKey
							arg
							"lookup"=lookupView
					<,
						|-
							hasKey
							arg
							"select"=selectView
					<,
						|-
							hasKey
							arg
							"current"=currentView
					<,
						|-
							if
							-
								hasKey
								arg
								"program"
							,
								then=,
									|-
										sum
										-
											foreach
											-
												range
												-
													count
													.
														arg
														program
											,
												key|,
													value|-
														equal
														.
															arg
															program
															<key
															key
														+
															,
																lookup=,
																	literal=key
										and
					=listProgramView
					<,
						|-
							hasKey
							arg
							"program"
					=programView
				,
					|-
						mapView
						arg
	load=,
		|-
			merge
			.
				panel
				Children
				1
			,
				Content=-
					parse
					-
						.
							Binary
							Deserialize_String
						path
	currentData=,
		|-
			.
				panel
				Children
				1
				Content
				getMap
	commands=+
		,
			header="File"
			items=+
				,
					header="Open"
					click=,
						|-
							.
								,
									&=-
										OpenFileDialog
										OpenFileDialog
									Filter="*.meta (Meta files)|*.meta"
									FileOk=,
										dialog|,
											|,
												!path=.
													dialog
													FileName
												asdf=-
													load
								ShowDialog
				,
					header="SaveAs"
					click=,
						|-
							.
								,
									&=-
										.
											SaveFileDialog
											SaveFileDialog
									Filter="*.meta (Meta files)|*.meta"
									DefaultExt=".meta"
									AddExtension=1
									FileOk=,
										dialog|,
											|,
												!path=.
													dialog
													FileName
												asdf=-
													Save
								ShowDialog
				,
					header="Save"
					click=,
						|-
							if
							-
								isEmpty
								path
							,
								then=,
									|-
										SaveAs
								else=,
									|-
										.
											Binary
											Serialize_Map_String
										-
											currentData
										path
				,
					header="Exit"
					click=,
						|-
							.
								window
								Close
		,
			header="Debug"
			items=+
				,
					header="Run"
					click=,
						|+
							-
								print
								-
									currentData
							-
								.
									File
									Save
							-
								.
									Process
									Start_String_String
								"C:\Meta\0.2\Meta.exe"
								path
	menu=-
		Menu
		,
			<.
				DockPanel
				DockProperty=.
				Dock
				Top
			Items=-
				apply
				commands
				,
					value|-
						MenuItem
						,
							Header=.
								value
								header
							Items=-
								apply
								.
									value
									items
								,
									value|-
										.
											MenuItem
										,
											Header=.
												value
												header
											Click=,
												sender|.
													value
													click
	panel=-
		DockPanel
		,
			Children=+
				menu
				-
					ScrollViewer
	path="C:\asdf.meta"
	asdf=-
		load
	window=-
		Window
		,
			Content=panel
	1=-
		.
			-
				Application
			Run_Window
		window